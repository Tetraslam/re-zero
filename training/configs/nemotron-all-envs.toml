# Nemotron 3 Nano x All 5 CTF Environments
# 2x H100: GPU 0 = inference (vLLM), GPU 1 = trainer (torchrun)

inference_gpu_ids = [0]
trainer_gpu_ids = [1]

max_steps = 200
seq_len = 4096
clean = false
output_dir = "/root/checkpoints/nemotron-all-envs"

[model]
name = "nvidia/NVIDIA-Nemotron-3-Nano-30B-A3B-BF16"

[wandb]
project = "re-zero"
name = "nemotron-nano-all-envs"
offline = true

[ckpt]
interval = 5
keep_last = 3

[trainer.model]
trust_remote_code = true
attn = "sdpa"

[trainer.optim]
lr = 1e-5
weight_decay = 0.0

[orchestrator]
batch_size = 512
rollouts_per_example = 16

[orchestrator.sampling]
max_tokens = 512

[[orchestrator.env]]
id = "intertwine/sv-env-redteam-attack"

[[orchestrator.env]]
id = "intertwine/sv-env-code-vulnerability"

[[orchestrator.env]]
id = "intertwine/sv-env-config-verification"

[[orchestrator.env]]
id = "intertwine/sv-env-network-logs"

[[orchestrator.env]]
id = "intertwine/sv-env-phishing-detection"

[inference.model]
trust_remote_code = true
enable_auto_tool_choice = true
tool_call_parser = "hermes"

[inference.parallel]
dp = 1
